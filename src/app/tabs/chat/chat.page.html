<ion-content class="hide-scrollbar">
  <!-- Global styles for hiding scrollbars -->
  <style>
    .hide-scrollbar {
      scrollbar-width: none !important; /* Firefox */
      -ms-overflow-style: none !important; /* IE and Edge */
    }
    .hide-scrollbar::-webkit-scrollbar {
      display: none !important; /* Chrome, Safari, Opera */
      width: 0 !important;
      height: 0 !important;
    }
    
    /* Apply to ion-content scrollable area */
    ion-content::part(scroll) {
      scrollbar-width: none !important;
      -ms-overflow-style: none !important;
    }
    ion-content::part(scroll)::-webkit-scrollbar {
      display: none !important;
      width: 0 !important;
      height: 0 !important;
    }
  </style>
  <!-- Top image -->
  <div class="top-image">
    <img
      [src]="darkModeEnabled ? 'assets/top-chat-white.png' : 'assets/top-chat.png'"
      alt="Chats Header"
    />
  </div>

  <!-- Segment for switching between Chats and Active -->
  <ion-segment
    [(ngModel)]="segmentValue"
    (ionChange)="onSegmentChange($event)"
    class="custom-segment"
  >
    <ion-segment-button
      value="chats"
      class="custom-segment-button dark:text-darkText"
    >
      <ion-label>Chats ({{ recentChats.length }})</ion-label>
    </ion-segment-button>
    <ion-segment-button value="active" class="custom-segment-button">
      <ion-label>Active ({{ activeUsers.length }})</ion-label>
    </ion-segment-button>
  </ion-segment>

  <!-- Chats Section -->
<ion-list *ngIf="segmentValue === 'chats'" class="user-list hide-scrollbar">
  <ng-container *ngFor="let chat of recentChats">
    <ion-item
      *ngIf="chat.otherParticipant?.fullName"
      lines="none"
      class="user-item"
      (click)="startChat(chat.otherParticipant.uid)"
    >
      <ion-avatar slot="start">
        <img
          [src]="chat.otherParticipant?.profilePictureUrl || './assets/profile-placeholder.jpg'"
        />
      </ion-avatar>

      <ion-label>
        <h2>{{ chat.otherParticipant?.fullName || 'Unknown User' }}</h2>
        <p>{{ chat.lastMessage?.content || 'No messages yet' }}</p>
      </ion-label>

      <!-- Badge for unread messages -->
      <ion-badge *ngIf="chat.unreadCount > 0" color="danger" slot="end">
        {{ chat.unreadCount }}
      </ion-badge>
    </ion-item>
  </ng-container>
</ion-list>

  <!-- Active Section -->
  <ion-list *ngIf="segmentValue === 'active' && activeUsers.length > 0" class="user-list hide-scrollbar">
    <ion-item 
      *ngFor="let user of activeUsers" 
      lines="none"
      class="user-item active-item"
      (click)="startChat(user.id)">
      <ion-avatar slot="start">
        <img [src]="user.avatar || './assets/profile-placeholder.jpg'" />
      </ion-avatar>
      <ion-label>
        <h2>{{ user.fullName || 'Unknown User' }}</h2>
        <p>{{ user.status || 'Active now' }}</p>
      </ion-label>
      <ion-icon
        name="ellipse"
        color="success"
        slot="end"
        class="status-icon"
      ></ion-icon>
    </ion-item>
  </ion-list>
  <div *ngIf="segmentValue === 'active' && activeUsers.length === 0" style="
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    margin: 1rem;
    border-radius: 12px;
    background-color: var(--ion-card-background);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
    min-height: 150px;">
    <ion-icon name="people-outline" style="
      font-size: 48px;
      color: var(--ion-color-medium);
      margin-bottom: 1rem;"></ion-icon>
    <h2
    id="no-active-user"
     style="
      margin: 0;
      font-size: 18px;
      font-weight: 500;
      color: var(--ion-text-color);">No active users</h2>
    <p style="
      margin-top: 0.5rem;
      font-size: 14px;
      color: var(--ion-color-medium);">Check back later or start a new conversation</p>
  </div>
</ion-content>
